<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Doubly Linked List Visualizer</title>

<style>
/* ===== SAME VISUAL STYLE AS SINGLE LINKED LIST ===== */
* { box-sizing: border-box; }

body {
  margin: 0;
  font-family: "Segoe UI", sans-serif;
  background: #f6f9fc;
}

.back-btn {
  position: fixed;
  top: 16px;
  left: 16px;
  font-size: 34px;
  font-weight: 700;
  color: #2563eb;
  text-decoration: none;
}

.header-bar {
  height: 80px;
  background: #ffffff;
  display: flex;
  justify-content: center;
  align-items: center;
  border-bottom: 1px solid #e5e7eb;
}
.header-bar h1 {
  font-size: 36px;
  color: #1d4ed8;
}

.main {
  max-width: 1400px;
  margin: 40px auto;
  display: grid;
  grid-template-columns: 360px 1fr;
  gap: 28px;
}

#panel {
  background: #ffffff;
  padding: 22px;
  border-radius: 16px;
}

input, button {
  width: 100%;
  margin-top: 10px;
  padding: 12px;
  border-radius: 10px;
  border: 1px solid #d1d5db;
}

button {
  background: #2563eb;
  color: white;
  border: none;
  font-weight: 600;
}

#status {
  margin-top: 14px;
  padding: 10px;
  background: #eff6ff;
  color: #1d4ed8;
  text-align: center;
  border-radius: 8px;
  font-weight: 600;
}

/* CODE PANEL */
#codePanel {
  margin-top: 14px;
  background: white;
  padding: 10px;
  border-radius: 10px;
  font-family: Consolas, monospace;
}
.code-line {
  padding: 6px 8px;
  border-radius: 6px;
}
.active {
  background: #cceeff;
  font-weight: bold;
}

/* VISUAL */
.visual-card {
  background: #ffffff;
  padding: 24px;
  border-radius: 16px;
}

#visual {
  position: relative;
  display: flex;
  align-items: center;
  padding-left: 40px;
  min-height: 220px;
  transition: transform 0.4s ease;
}

/* HEAD */
#head {
  position: absolute;
  top: 10px;
  left: 40px;
  display: flex;
  flex-direction: column;
  align-items: center;
}
#head span {
  background: #16a34a;
  color: white;
  padding: 4px 8px;
  border-radius: 6px;
  font-size: 12px;
}
#head-arrow {
  width: 18px;
  height: 18px;
  border-left: 3px solid #16a34a;
  border-bottom: 3px solid #16a34a;
  transform: rotate(-45deg);
  margin-top: 4px;
}

/* NODE (same as single LL) */
.node {
  display: flex;
  border-radius: 12px;
  overflow: hidden;
  margin-right: 14px;
  background: #3b82f6;
  box-shadow: 0 6px 18px rgba(59,130,246,0.35);
  transition: background 0.3s;
}

.prev, .data, .next {
  width: 90px;
  height: 60px;
  display: flex;
  justify-content: center;
  align-items: center;
  color: white;
}

.data {
  font-size: 22px;
  font-weight: bold;
  border-left: 2px solid rgba(255,255,255,0.4);
  border-right: 2px solid rgba(255,255,255,0.4);
}

.arrow {
  font-size: 36px;
  margin: 0 16px;
  color: #94a3b8;
}
</style>
</head>

<body>

<a class="back-btn" href="linkedlist.html">←</a>

<div class="header-bar">
  <h1>Doubly Linked List</h1>
</div>

<div class="main">

<div id="panel">
  <input id="valueInput" placeholder="Enter value" />
  <button onclick="startInsert()">Insert</button>
  <button onclick="startDelete()">Delete</button>
  <button onclick="startSearch()">Search</button>
  <button onclick="resetList()">Reset</button>

  <div id="status">Ready</div>
  <div id="codePanel"></div>
</div>

<div class="visual-card">
  <h3>Visualization</h3>
  <div id="visual"></div>
</div>

</div>

<script>
let list = [];
let timer = null;
let idx = 0;
let phase = 0;
let key = "";

/* ===== PSEUDOCODES ===== */
const codeMap = {
  insert: [
    "create new node",
    "if head == null",
    "head = new node",
    "else",
    "traverse to last",
    "link new node"
  ],
  delete: [
    "if head == null",
    "current = head",
    "if current.data == key",
    "unlink node",
    "move current",
    "key not found"
  ],
  search: [
    "current = head",
    "if current.data == key",
    "mark node found",
    "move to next",
    "return not found"
  ]
};

function showCode(type) {
  codePanel.innerHTML = "";
  codeMap[type].forEach((l,i)=>{
    const d=document.createElement("div");
    d.className="code-line";
    d.id="c"+i;
    d.innerText=l;
    codePanel.appendChild(d);
  });
}
function highlight(i){
  document.querySelectorAll(".code-line").forEach(d=>d.classList.remove("active"));
  const el=document.getElementById("c"+i);
  if(el) el.classList.add("active");
}

/* ===== RENDER ===== */
function render(){
  visual.innerHTML="";
  if(!list.length) return;

  const head=document.createElement("div");
  head.id="head";
  head.innerHTML=`<span>HEAD</span><div id="head-arrow"></div>`;
  visual.appendChild(head);

  list.forEach((v,i)=>{
    const node=document.createElement("div");
    node.className="node";
    node.innerHTML=`
      <div class="prev">${i===0?"NULL":"PREV"}</div>
      <div class="data">${v}</div>
      <div class="next">${i===list.length-1?"NULL":"NEXT"}</div>
    `;
    visual.appendChild(node);

    if(i!==list.length-1){
      const arrow=document.createElement("div");
      arrow.className="arrow";
      arrow.innerText="→";
      visual.appendChild(arrow);
    }
  });
}

/* ================= INSERT ================= */
function startInsert(){
  key=valueInput.value;
  if(!key) return;

  idx=0; phase=0;
  showCode("insert");
  clearInterval(timer);

  timer=setInterval(()=>{
    if(phase===0){ highlight(0); phase=1; }
    else if(phase===1){
      highlight(1);
      phase = list.length===0 ? 2 : 3;
    }
    else if(phase===2){
      highlight(2);
      list.push(key);
      render();
      status.innerText=`Inserted ${key}`;
      clearInterval(timer);
    }
    else if(phase===3){
      highlight(4);
      phase=4;
    }
    else if(phase===4){
      highlight(5);
      list.push(key);
      render();
      status.innerText=`Inserted ${key}`;
      clearInterval(timer);
    }
  },700);
}

/* ================= DELETE ================= */
function startDelete(){
  key=valueInput.value;
  if(!key) return;

  idx=0; phase=0;
  showCode("delete");
  clearInterval(timer);

  timer=setInterval(()=>{
    if(list.length===0){
      highlight(0);
      status.innerText="List is empty";
      clearInterval(timer);
      return;
    }

    if(idx>=list.length){
      highlight(5);
      status.innerText=`${key} not found`;
      clearInterval(timer);
      return;
    }

    if(phase===0){ highlight(1); phase=1; }
    else if(phase===1){
      highlight(2);
      if(list[idx]==key) phase=2;
      else phase=3;
    }
    else if(phase===2){
      highlight(3);
      list.splice(idx,1);
      render();
      status.innerText=`Deleted ${key}`;
      clearInterval(timer);
    }
    else if(phase===3){
      highlight(4);
      idx++; phase=0;
    }
  },700);
}

/* ================= SEARCH ================= */
function startSearch(){
  key=valueInput.value;
  if(!key) return;

  idx=0; phase=0;
  showCode("search");
  clearInterval(timer);

  timer=setInterval(()=>{
    const nodes=document.querySelectorAll(".node");

    if(idx>=nodes.length){
      highlight(4);
      status.innerText=`${key} not found`;
      clearInterval(timer);
      return;
    }

    nodes.forEach(n=>n.style.background="#3b82f6");

    if(phase===0){ highlight(0); phase=1; }
    else if(phase===1){
      highlight(1);
      nodes[idx].style.background="#facc15";
      if(list[idx]==key) phase=2;
      else phase=3;
    }
    else if(phase===2){
      highlight(2);
      nodes[idx].style.background="#22c55e";
      visual.style.transform="translateY(40px)";
      status.innerText=`${key} found at position ${idx}`;
      clearInterval(timer);
    }
    else if(phase===3){
      highlight(3);
      idx++; phase=0;
    }
  },700);
}

/* ================= RESET ================= */
function resetList(){
  clearInterval(timer);
  list=[];
  visual.innerHTML="";
  visual.style.transform="translateY(0)";
  codePanel.innerHTML="";
  status.innerText="Reset completed";
}
</script>

</body>
</html>
